<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ANE打包步骤 | Sunbufu's blog</title><meta name=keywords content="ANE,,Android,,IOS"><meta name=description content="ANE的打包步骤（包括Android和IOS）"><meta name=author content="sunbufu"><link rel=canonical href=https://sunbufu.vercel.app/posts/2018-and-before/2018-06-06-ane-android-ios/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2d6dbfc6e0f8a1db1c9d082a76dc11d094328cf63f247bbc2421dfaa7f2bb170.css integrity="sha256-LW2/xuD4odscnQgqdtwR0JQyjPY/JHu8JCHfqn8rsXA=" rel="preload stylesheet" as=style><link rel=preload href=icon/favicon-152x152.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://sunbufu.vercel.app/icon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sunbufu.vercel.app/icon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sunbufu.vercel.app/icon/favicon-32x32.png><link rel=apple-touch-icon href=https://sunbufu.vercel.app/icon/apple-touch-icon.png><link rel=mask-icon href=https://sunbufu.vercel.app/icon/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-123-45','auto'),ga('send','pageview'))</script><meta property="og:title" content="ANE打包步骤"><meta property="og:description" content="ANE的打包步骤（包括Android和IOS）"><meta property="og:type" content="article"><meta property="og:url" content="https://sunbufu.vercel.app/posts/2018-and-before/2018-06-06-ane-android-ios/"><meta property="og:image" content="https://sunbufu.vercel.app/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-06-06T00:00:00+00:00"><meta property="article:modified_time" content="2018-06-06T00:00:00+00:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sunbufu.vercel.app/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="ANE打包步骤"><meta name=twitter:description content="ANE的打包步骤（包括Android和IOS）"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sunbufu.vercel.app/posts/"},{"@type":"ListItem","position":2,"name":"ANE打包步骤","item":"https://sunbufu.vercel.app/posts/2018-and-before/2018-06-06-ane-android-ios/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ANE打包步骤","name":"ANE打包步骤","description":"ANE的打包步骤（包括Android和IOS）","keywords":["ANE,","Android,","IOS"],"articleBody":"一、新建工程 1、新建Android工程 记得选中Mark this project as a library\n1.1 构建路径导入Jar包 FlashRuntimeExtensions.jar 路径如：flashbuilder\\sdks\\4.6.0\\lib\\android\\\n1.2 三个必须类：  实现FREFunction，实现其中的call方法。call方法是真正和android交互的方法。 继承FREContext，其中的getFunctions方法用于获取1）的类对象的Map容器，容器的key用于以后获取该对象。 实现FREExtension，其中createContext方法用于获取2）类的对象。  1.3 导出*.jar包 2、新建iPhone工程（Cocoa Touch Static Library） 2.1 导入头文件 FlashRuntimeExtensions.h 路径如：Application/Adobe Flash Builder 4.6/sdks/4.6.0/include/\n2.2 必须实现的方法  contextInitializer用来执行初始化操作（例如将与iPhone的原生实现的方法添加到里面） iPhone的原生实现的方法  2.3 导出*.a静态库 command+B,编译出*.a文件\n二、新建AS的Lib工程，用于调用一、（记得选中包括Adobe AIR库） var context:ExtensionContext = ExtensionContext.createExtensionContext(\"com.three.Extension\",\"\");//com.three.Extension为Android项目中FREExtension的实现的全路径名 context.call(\"test\", value);//为FREContext的子类Map容器的key\t复制出AS工程bin目录下的*.swc文件 注意：有时需要在Flex库编译器中添加 -swf-version 18\n三、新建extension.xml文件 内容如下：\n xmlns=\"http://ns.adobe.com/air/extension/20.0\" shs.ANE.pay 1.0.0   name=\"iPhone-ARM\"  libPayiPhone.a init    name=\"Android-ARM\"  PayAndroid.jar shs.ANE.PayExtension     四、按一下目录结构放置文件： 其中：\n*.ane—-最后获得的ane文件\n*.swc—-FB编译得到的调用原生代码的文件\nAndroid-ARM—-Android用到的文件目录\niPhone-ARM—–iPhone用到的文件目录\npackage.sh—-打包的命令脚本\nextension.xml—-ANE的配置文件\nplatformoptions.xml—-iPhone中需要用到的库文件的引用的配置\nres—-存放Android中用到的资源文件\nlibs—-存放iPhone中用到的库文件。\n五、执行打包命令 adt路径 -package -tsa none -storetype pkcs12 -keystore p12文件 -storepass 密码 -target ane 生成的ANE名称 extension.xml -swc swc文件 -platform Android-ARM -C ./Android-ARM . -platform iPhone-ARM -platformoptions platformoptions.xml -C ./iPhone-ARM . 六、遇到的问题和解决方案 6.1 Android 6.1.1 在打包*.jar的过程中注意勾选Export all output folders for checked projects。然后将Android中的res拷贝出来。 6.1.2 在打包ANE之前，要将jar包及其引用的jar包合并成一个jar包，命令如下： \t@echo off ::转到当前盘符 %~d0 ::打开当前目录 cd %~dp0 ::你做的主JAR包的路径 set MainJar=PayAndroid.jar ::第三方JAR包的路径 set ExternalJar=alipaySdk-20160223.jar ::第三方JAR包顶级包名称 set packageName=com echo =========== start combin ============== ::解压第三方包 jar -xf %ExternalJar% ::合并主JAR包 jar -uf %MainJar% %packageName% ::如果还有别的顶级包可以接着合并，例如： ::jar -uf %MainJar% %packageName2% jar -uf %MainJar% org ::jar -uf %MainJar% cn echo =========== over ============== echo 合并完成 6.1.3 安卓也可以主动调用AS中的方法： /**1) Android中*/ context.dispatchStatusEventAsync(TAG, result); /**2) AS中*/ context.addEventListener(StatusEvent.STATUS, statusHandler); private function statusHandler(event:StatusEvent):void { dispatchEvent(event); trace(event.leve); } 6.2 iPhone 6.2.1 打包过程中注意库文件的引用，也就是platformoptions.xml的配置  xmlns=\"http://ns.adobe.com/air/extension/20.0\" 1.0  -ios_version_min 6.0 -framework AlipaySDK   libs/libcrypto.a libs/libssl.a libs/AlipaySDK.framework   6.2.2 异步返回 因为在支付宝的调用过程中，支付结果的返回时异步的。*.a文件又不存在AppDelegate类。所以需要我们动态的替换掉这个类。 参照利用ios的hook机制实现adobe air ios ane下appdelegate的动态替换\n6.2.3 主动发送数据到AS 类似于6.1.3\n/**1) iPhone中*/ FREDispatchStatusEventAsync(FREContext ctx, const uint8_t *code, const uint8_t *level); /**2) AS中*/ context.addEventListener(StatusEvent.STATUS, statusHandler); private function statusHandler(event:StatusEvent):void { dispatchEvent(event); trace(event.leve); } 6.2.4 必须在MACOS环境下打包 ","wordCount":"243","inLanguage":"en","datePublished":"2018-06-06T00:00:00Z","dateModified":"2018-06-06T00:00:00Z","author":{"@type":"Person","name":"sunbufu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sunbufu.vercel.app/posts/2018-and-before/2018-06-06-ane-android-ios/"},"publisher":{"@type":"Organization","name":"Sunbufu's blog","logo":{"@type":"ImageObject","url":"https://sunbufu.vercel.app/icon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://sunbufu.vercel.app/ accesskey=h title="Sunbufu's blog (Alt + H)">Sunbufu's blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://sunbufu.vercel.app/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://sunbufu.vercel.app/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://sunbufu.vercel.app/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sunbufu.vercel.app/>Home</a>&nbsp;»&nbsp;<a href=https://sunbufu.vercel.app/posts/>Posts</a></div><h1 class=post-title>ANE打包步骤</h1><div class=post-description>ANE的打包步骤（包括Android和IOS）</div><div class=post-meta>June 6, 2018&nbsp;·&nbsp;2 min&nbsp;·&nbsp;sunbufu</div></header><div class=post-content><h1 id=一新建工程>一、新建工程<a hidden class=anchor aria-hidden=true href=#一新建工程>#</a></h1><h2 id=1新建android工程>1、新建Android工程<a hidden class=anchor aria-hidden=true href=#1新建android工程>#</a></h2><p><strong>记得选中<code>Mark this project as a library</code></strong></p><h3 id=11-构建路径导入jar包>1.1 构建路径导入Jar包<a hidden class=anchor aria-hidden=true href=#11-构建路径导入jar包>#</a></h3><p>FlashRuntimeExtensions.jar
路径如：flashbuilder\sdks\4.6.0\lib\android\</p><h3 id=12-三个必须类>1.2 三个必须类：<a hidden class=anchor aria-hidden=true href=#12-三个必须类>#</a></h3><ol><li>实现<code>FREFunction</code>，实现其中的<code>call</code>方法。<code>call</code>方法是真正和<code>android</code>交互的方法。</li><li>继承<code>FREContext</code>，其中的<code>getFunctions</code>方法用于获取1）的类对象的<code>Map</code>容器，容器的<code>key</code>用于以后获取该对象。</li><li>实现<code>FREExtension</code>，其中<code>createContext</code>方法用于获取2）类的对象。</li></ol><h3 id=13-导出jar包>1.3 导出*.jar包<a hidden class=anchor aria-hidden=true href=#13-导出jar包>#</a></h3><h2 id=2新建iphone工程cocoa-touch-static-library>2、新建iPhone工程（Cocoa Touch Static Library）<a hidden class=anchor aria-hidden=true href=#2新建iphone工程cocoa-touch-static-library>#</a></h2><h3 id=21-导入头文件>2.1 导入头文件<a hidden class=anchor aria-hidden=true href=#21-导入头文件>#</a></h3><p>FlashRuntimeExtensions.h
路径如：Application/Adobe Flash Builder 4.6/sdks/4.6.0/include/</p><h3 id=22-必须实现的方法>2.2 必须实现的方法<a hidden class=anchor aria-hidden=true href=#22-必须实现的方法>#</a></h3><ol><li>contextInitializer用来执行初始化操作（例如将与iPhone的原生实现的方法添加到里面）</li><li>iPhone的原生实现的方法</li></ol><h3 id=23-导出a静态库>2.3 导出*.a静态库<a hidden class=anchor aria-hidden=true href=#23-导出a静态库>#</a></h3><p>command+B,编译出*.a文件</p><h1 id=二新建as的lib工程用于调用一记得选中包括adobe-air库>二、新建AS的Lib工程，用于调用一、（记得选中包括Adobe AIR库）<a hidden class=anchor aria-hidden=true href=#二新建as的lib工程用于调用一记得选中包括adobe-air库>#</a></h1><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>context</span><span style=color:#f92672>:</span><span style=color:#a6e22e>ExtensionContext</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ExtensionContext</span>.<span style=color:#a6e22e>createExtensionContext</span>(<span style=color:#e6db74>&#34;com.three.Extension&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>);<span style=color:#75715e>//com.three.Extension为Android项目中FREExtension的实现的全路径名
</span><span style=color:#75715e></span><span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>call</span>(<span style=color:#e6db74>&#34;test&#34;</span>, <span style=color:#a6e22e>value</span>);<span style=color:#75715e>//为FREContext的子类Map容器的key	
</span></code></pre></div><p>复制出AS工程bin目录下的*.swc文件
注意：有时需要在Flex库编译器中添加 -swf-version 18</p><h1 id=三新建extensionxml文件>三、新建extension.xml文件<a hidden class=anchor aria-hidden=true href=#三新建extensionxml文件>#</a></h1><p>内容如下：</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;extension</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://ns.adobe.com/air/extension/20.0&#34;</span><span style=color:#f92672>&gt;</span>
	<span style=color:#f92672>&lt;id&gt;</span>shs.ANE.pay<span style=color:#f92672>&lt;/id&gt;</span>
	<span style=color:#f92672>&lt;versionNumber&gt;</span>1.0.0<span style=color:#f92672>&lt;/versionNumber&gt;</span>
	<span style=color:#f92672>&lt;platforms&gt;</span>
		<span style=color:#f92672>&lt;platform</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;iPhone-ARM&#34;</span><span style=color:#f92672>&gt;</span>
			<span style=color:#f92672>&lt;applicationDeployment&gt;</span>
				<span style=color:#f92672>&lt;nativeLibrary&gt;</span>libPayiPhone.a<span style=color:#f92672>&lt;/nativeLibrary&gt;</span>
				<span style=color:#f92672>&lt;initializer&gt;</span>init<span style=color:#f92672>&lt;/initializer&gt;</span>
			<span style=color:#f92672>&lt;/applicationDeployment&gt;</span>
		<span style=color:#f92672>&lt;/platform&gt;</span>
        <span style=color:#f92672>&lt;platform</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;Android-ARM&#34;</span><span style=color:#f92672>&gt;</span>
            <span style=color:#f92672>&lt;applicationDeployment&gt;</span>
                <span style=color:#f92672>&lt;nativeLibrary&gt;</span>PayAndroid.jar<span style=color:#f92672>&lt;/nativeLibrary&gt;</span>
                <span style=color:#f92672>&lt;initializer&gt;</span>shs.ANE.PayExtension<span style=color:#f92672>&lt;/initializer&gt;</span>
            <span style=color:#f92672>&lt;/applicationDeployment&gt;</span>
        <span style=color:#f92672>&lt;/platform&gt;</span>
	<span style=color:#f92672>&lt;/platforms&gt;</span>
<span style=color:#f92672>&lt;/extension&gt;</span>
</code></pre></div><h1 id=四按一下目录结构放置文件>四、按一下目录结构放置文件：<a hidden class=anchor aria-hidden=true href=#四按一下目录结构放置文件>#</a></h1><p><img loading=lazy src=/posts/2018-and-before/20160309132231238.jpg alt=目录结构></p><p>其中：<br>*.ane&mdash;-最后获得的ane文件<br>*.swc&mdash;-FB编译得到的调用原生代码的文件<br>Android-ARM&mdash;-Android用到的文件目录<br>iPhone-ARM&mdash;&ndash;iPhone用到的文件目录<br>package.sh&mdash;-打包的命令脚本<br>extension.xml&mdash;-ANE的配置文件<br>platformoptions.xml&mdash;-iPhone中需要用到的库文件的引用的配置<br>res&mdash;-存放Android中用到的资源文件<br>libs&mdash;-存放iPhone中用到的库文件。</p><h1 id=五执行打包命令>五、执行打包命令<a hidden class=anchor aria-hidden=true href=#五执行打包命令>#</a></h1><pre><code>adt路径 -package -tsa none -storetype pkcs12 -keystore p12文件 -storepass 密码 -target ane 生成的ANE名称 extension.xml -swc swc文件 -platform Android-ARM -C ./Android-ARM . -platform iPhone-ARM -platformoptions platformoptions.xml -C ./iPhone-ARM .
</code></pre><h1 id=六遇到的问题和解决方案>六、遇到的问题和解决方案<a hidden class=anchor aria-hidden=true href=#六遇到的问题和解决方案>#</a></h1><h2 id=61-android>6.1 Android<a hidden class=anchor aria-hidden=true href=#61-android>#</a></h2><h3 id=611-在打包jar的过程中注意勾选export-all-output-folders-for-checked-projects然后将android中的res拷贝出来>6.1.1 在打包*.jar的过程中注意勾选Export all output folders for checked projects。然后将Android中的res拷贝出来。<a hidden class=anchor aria-hidden=true href=#611-在打包jar的过程中注意勾选export-all-output-folders-for-checked-projects然后将android中的res拷贝出来>#</a></h3><h3 id=612-在打包ane之前要将jar包及其引用的jar包合并成一个jar包命令如下>6.1.2 在打包ANE之前，要将jar包及其引用的jar包合并成一个jar包，命令如下：<a hidden class=anchor aria-hidden=true href=#612-在打包ane之前要将jar包及其引用的jar包合并成一个jar包命令如下>#</a></h3><pre><code>	@echo off
	::转到当前盘符
	%~d0
	::打开当前目录
	cd %~dp0
	::你做的主JAR包的路径
	set MainJar=PayAndroid.jar
	::第三方JAR包的路径
	set ExternalJar=alipaySdk-20160223.jar
	::第三方JAR包顶级包名称
	set packageName=com
	echo =========== start combin ==============
	::解压第三方包
	jar -xf %ExternalJar%
	::合并主JAR包
	jar -uf %MainJar% %packageName% 
	::如果还有别的顶级包可以接着合并，例如：
	::jar -uf %MainJar% %packageName2%
	jar -uf %MainJar% org
	::jar -uf %MainJar% cn
	echo =========== over ==============
	echo 合并完成
</code></pre><h3 id=613-安卓也可以主动调用as中的方法>6.1.3 安卓也可以主动调用AS中的方法：<a hidden class=anchor aria-hidden=true href=#613-安卓也可以主动调用as中的方法>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#75715e>/**1) Android中*/</span>
<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>dispatchStatusEventAsync</span>(<span style=color:#a6e22e>TAG</span>, <span style=color:#a6e22e>result</span>);
<span style=color:#75715e>/**2) AS中*/</span>
<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#a6e22e>StatusEvent</span>.<span style=color:#a6e22e>STATUS</span>, <span style=color:#a6e22e>statusHandler</span>);
		
<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>statusHandler</span>(<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span><span style=color:#a6e22e>StatusEvent</span>)<span style=color:#f92672>:</span><span style=color:#66d9ef>void</span>
{
	<span style=color:#a6e22e>dispatchEvent</span>(<span style=color:#a6e22e>event</span>);
	<span style=color:#a6e22e>trace</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>leve</span>);
}
</code></pre></div><h2 id=62-iphone>6.2 iPhone<a hidden class=anchor aria-hidden=true href=#62-iphone>#</a></h2><h3 id=621-打包过程中注意库文件的引用也就是platformoptionsxml的配置>6.2.1 打包过程中注意库文件的引用，也就是platformoptions.xml的配置<a hidden class=anchor aria-hidden=true href=#621-打包过程中注意库文件的引用也就是platformoptionsxml的配置>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;platform</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://ns.adobe.com/air/extension/20.0&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;sdkVersion&gt;</span>1.0<span style=color:#f92672>&lt;/sdkVersion&gt;</span>
    <span style=color:#f92672>&lt;linkerOptions&gt;</span>
        <span style=color:#f92672>&lt;option&gt;</span>-ios_version_min 6.0<span style=color:#f92672>&lt;/option&gt;</span>
        <span style=color:#f92672>&lt;option&gt;</span>-framework AlipaySDK<span style=color:#f92672>&lt;/option&gt;</span>
    <span style=color:#f92672>&lt;/linkerOptions&gt;</span>
    <span style=color:#f92672>&lt;packagedDependencies&gt;</span>
        <span style=color:#f92672>&lt;packagedDependency&gt;</span>libs/libcrypto.a<span style=color:#f92672>&lt;/packagedDependency&gt;</span>
        <span style=color:#f92672>&lt;packagedDependency&gt;</span>libs/libssl.a<span style=color:#f92672>&lt;/packagedDependency&gt;</span>
        <span style=color:#f92672>&lt;packagedDependency&gt;</span>libs/AlipaySDK.framework<span style=color:#f92672>&lt;/packagedDependency&gt;</span>
    <span style=color:#f92672>&lt;/packagedDependencies&gt;</span>
<span style=color:#f92672>&lt;/platform&gt;</span>
</code></pre></div><h3 id=622-异步返回>6.2.2 异步返回<a hidden class=anchor aria-hidden=true href=#622-异步返回>#</a></h3><p>因为在支付宝的调用过程中，支付结果的返回时异步的。*.a文件又不存在AppDelegate类。所以需要我们动态的替换掉这个类。
参照<a href=http://blog.csdn.net/ashqal/article/details/40979353>利用ios的hook机制实现adobe air ios ane下appdelegate的动态替换</a></p><h3 id=623-主动发送数据到as>6.2.3 主动发送数据到AS<a hidden class=anchor aria-hidden=true href=#623-主动发送数据到as>#</a></h3><p>类似于6.1.3</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#75715e>/**1) iPhone中*/</span>
<span style=color:#a6e22e>FREDispatchStatusEventAsync</span>(<span style=color:#a6e22e>FREContext</span> <span style=color:#a6e22e>ctx</span>, <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uint8_t</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>code</span>, <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uint8_t</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>level</span>);
<span style=color:#75715e>/**2) AS中*/</span>
<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#a6e22e>StatusEvent</span>.<span style=color:#a6e22e>STATUS</span>, <span style=color:#a6e22e>statusHandler</span>);

<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>statusHandler</span>(<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span><span style=color:#a6e22e>StatusEvent</span>)<span style=color:#f92672>:</span><span style=color:#66d9ef>void</span>
{
	<span style=color:#a6e22e>dispatchEvent</span>(<span style=color:#a6e22e>event</span>);
	<span style=color:#a6e22e>trace</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>leve</span>);
}
</code></pre></div><h3 id=624-必须在macos环境下打包>6.2.4 必须在MACOS环境下打包<a hidden class=anchor aria-hidden=true href=#624-必须在macos环境下打包>#</a></h3></div><footer class=post-footer><ul class=post-tags><li><a href=https://sunbufu.vercel.app/tags/action-script/>action script</a></li></ul><nav class=paginav><a class=prev href=https://sunbufu.vercel.app/posts/2018-and-before/2018-06-13-shortest-path-dijkstra/><span class=title>« Prev Page</span><br><span>最短路径-迪杰斯特拉</span></a>
<a class=next href=https://sunbufu.vercel.app/posts/2018-and-before/2018-06-06-sql-summary/><span class=title>Next Page »</span><br><span>SQL总结</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://sunbufu.vercel.app/>Sunbufu's blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>